# A-DIENYNAS Project Documentation

## PROJECT OVERVIEW

**A-DIENYNAS** is a modern student diary and learning management system built with Django REST API backend and Next.js frontend. As noted in README.md, the system is designed for "effective learning process organization" and includes management of five user types:

- **Students** - for learning progress tracking
- **Parents** - for monitoring children's progress  
- **Curators** - for student management and consulting
- **Mentors** - for subject teaching and evaluation
- **Administrators** - for complete system management

The system implements JWT authentication, modern responsive user interface, real-time updates, and RESTful API architecture.

### Technical Architecture

#### Backend (Django)

Technical implementation is based on modular Django application architecture, where `backend/core/settings.py` specifies **seven local applications**:

- `users` - user management
- `crm` - customer relationship management
- `schedule` - timetables
- `curriculum` - learning programs
- `grades` - grades
- `plans` - educational plans
- `violation` - violations/penalties management

#### API Structure

`backend/core/urls.py` shows API endpoint structure where each application has its own URL namespace:

```
/api/users/
/api/crm/
/api/schedule/
/api/curriculum/
/api/grades/
/api/plans/
/api/violations/
```

#### Authentication

Authentication implemented through Django Simple JWT with:
- Bearer token mechanism
- 60-minute access token validity
- PostgreSQL database in production, SQLite in development
- Email-based authentication (not username)
- Configured CORS support for frontend-backend communication
- Role-based permissions: student, parent, curator, mentor, manager

#### Frontend (Next.js)

Frontend implemented with:
- **Next.js 15** with App Router architecture
- **TypeScript** for type safety
- **Tailwind CSS** for styling
- **Zustand** state management
- **Axios** HTTP client for backend communication
- Automatic API proxying: `/api/:path*` → `http://localhost:8000/api/:path*`
- **Modular Navigation System** with role-based components

#### Navigation System Architecture

The frontend implements a modular navigation system located in `frontend/src/components/layout/Navigation/`:

**Core Components:**
- `BaseNavigation.tsx` - Main navigation wrapper with role-based rendering
- `MobileNavigation.tsx` - Mobile-responsive navigation menu
- `index.ts` - Centralized exports for all navigation components

**Role-Specific Navigation:**
- `roles/ManagerNavigation.tsx` - System manager navigation (Darbastalis + Skolos)
- `roles/CuratorNavigation.tsx` - Curator navigation (Darbastalis + Skolos)
- `roles/MentorNavigation.tsx` - Mentor navigation (Darbastalis + Veiklos + Pamokos + Ugdymo planai + Skolos)
- `roles/StudentNavigation.tsx` - Student navigation (Darbastalis + Skolos)
- `roles/ParentNavigation.tsx` - Parent navigation (Darbastalis + Skolos)

**Navigation Features:**
- Role-based menu rendering based on current URL path
- Responsive design with separate mobile/desktop layouts
- Consistent styling across all role components
- Centralized link management per role

#### Static Assets Organization

Static assets are organized in `frontend/public/` directory with structured subdirectories:
- `images/logos/` - logos and brand assets
- `images/icons/` - icons (SVG, PNG, ICO)
- `images/backgrounds/` - background images
- `images/avatars/` - profile pictures
- All assets are automatically accessible from root URL (e.g., `/images/icons/globe.svg`)

### Functionality Spectrum

Documented in README.md and FILE_STRUCTURE.md, functionality includes:

- Subject and level organization
- Student progress tracking
- Parent and curator relationship management
- Mentor and subject linking

### Data Structures

ADDITIONAL folder analysis shows system data structure complexity - there are **import scripts** for:

- Competencies
- Skills
- Virtues
- Lessons
- Students
- Subjects
- Learning levels

This indicates comprehensive educational system modeling with complex data structures.

## PERSONALITY

**A-DIENYNAS** is designed as a comprehensive educational management platform that prioritizes:
- **Simplicity in complexity** - handling complex educational data through intuitive interfaces
- **Role-based functionality** - each user type has tailored features and access levels
- **Data-driven insights** - extensive tracking and reporting capabilities
- **Modern development practices** - clean architecture, type safety, and maintainable code

## TECH STACK

### Backend Architecture

Backend architecture is based on **Django 5.2.4** framework with **Django REST Framework 3.16.0** for RESTful API development. System uses **SQLite database** (`django.db.backends.sqlite3`) in development environment, and authentication is implemented through **Django Simple JWT 5.5.1** with Bearer token mechanism. 

Backend consists of modularly organized Django applications: `users` (user management), `crm` (student-parent-curator relationship management), `curriculum` (learning programs), `plans` (educational plans), `grades` (grades), and `schedule` (timetables). 

CORS functionality is ensured through **django-cors-headers 4.3.1**, and additional security solutions include custom password validators with minimum 8-character requirement. System is configured for development mode with `DEBUG = True` and allowed all hosts and CORS origins.

### Frontend Technology Stack

Frontend technology solution is based on **Next.js 15.4.5** with App Router architecture and **React 19.1.0**. Project is fully written in **TypeScript 5** with ES2017 target configuration and strict mode enabled. 

UI layer is implemented through **Tailwind CSS 4** with PostCSS processing, and state management is performed by **Zustand 5.0.7** library. HTTP communication with backend is executed through **Axios 1.11.0** with automatic API proxying configuration (`/api/:path*` → `http://localhost:8000/api/:path*`). 

For form management, **React Hook Form 7.61.1** is used, and for UI components - **Radix UI primitives**, **Lucide React** for icons, **Recharts** for data visualization, and **clsx/tailwind-merge** utility libraries. Development environment has **Turbopack bundler** enabled through `next dev --turbopack` command, and code quality is ensured by **ESLint 9** with Next.js specific rules.

### Docker Infrastructure

System runs in **Docker containerized environment** with:
- **Production mode**: Gunicorn WSGI server for Django backend
- **Development mode**: Django dev server with DEBUG=True
- **Multi-container setup**: PostgreSQL, Redis, Django backend, Next.js frontend, Nginx reverse proxy
- **Network isolation**: Docker network (172.20.0.0/16)
- **Volume persistence**: Database, Redis, static files, media files
- **Environment-based deployment**: `DEBUG=False` for production, `DEBUG=True` for development

## ERROR FIXING PROCESS

When encountering errors, follow this systematic approach:

1. **Start by writing 3 reasoning paragraphs analyzing what the error might be**
   - DO NOT JUMP TO CONCLUSIONS
   - Analyze symptoms, context, and potential causes
   - Consider recent changes and system interactions

2. **Write reasoning paragraphs** that explore:
   - What specific error messages or behaviors are observed
   - What components or systems might be involved
   - What conditions or inputs might trigger the issue

3. **Answer in short** - provide concise solution in a few sentences

4. **DO NOT DELETE COMMENTS** - preserve existing code documentation

5. **Provide summary of current state** after implementing fixes

## BUILDING PROCESS

### Summary of Current State Requirements

Before proceeding with any development, provide a summary of the current project state.

#### Instructions

Format as **3 concise paragraphs** describing:

- What we just did
- What did not work
- Which files were updated/created
- What mistakes to avoid
- Any key insights/lessons learned
- What problems/errors we are facing
- Anything else a programmer needs to work productively on this project

#### Requirements

- Write in **conversational yet informative tone**
- Similar to a GitHub README that is super information dense
- **Without any fluff or noise**
- **DO NOT** include assumptions or theories, just facts
- Expect **three concise paragraphs**
- Written as if giving instructions to another programmer with ALL necessary context

#### Template Format

```markdown
**Paragraph 1:** [What was accomplished and current status]

**Paragraph 2:** [Issues encountered and solutions/workarounds]

**Paragraph 3:** [Next steps and critical information for continued development]
```

## OUR .ENV VARIABLES

### Docker Environment Configuration

Key environment files:
- `env.docker` - Docker environment variables for production deployment
- `.env` - Local environment overrides and development configuration

Critical variables:
```bash
# Database Configuration  
DATABASE_HOST=postgres                    # Docker service name
DATABASE_PORT=5432                       # PostgreSQL port
DATABASE_NAME=dienynas_db               # Database name
DATABASE_USER=dienynas_user             # Database user
DATABASE_PASSWORD=secure_password       # Database password

# Django Configuration
SECRET_KEY=your-secret-key-here         # Django secret key
DEBUG=False                             # Production: False, Development: True
ALLOWED_HOSTS=localhost,192.168.88.166  # Allowed hostnames

# JWT Authentication
JWT_ACCESS_TOKEN_LIFETIME=60            # Access token lifetime in minutes
JWT_REFRESH_TOKEN_LIFETIME=1440         # Refresh token lifetime in minutes

# CORS Configuration  
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://192.168.88.166:3000
CORS_ALLOW_ALL_ORIGINS=False           # Set True only for development
```

# CURRENT FILE STRUCTURE
├── ADITIONAL
│   ├── competencies.json
│   ├── competency_atcheve_example.json
│   ├── competency_example.json
│   ├── dual_list_transfer_component.tsx
│   ├── generate_student_subject_levels.py
│   ├── import_competencies.py
│   ├── import_competency_atcheves.py
│   ├── import_lessons.py
│   ├── import_levels.py
│   ├── import_skills.py
│   ├── import_students.py
│   ├── import_subjects_levels.py
│   ├── import_subjects.py
│   ├── import_virtues.py
│   ├── lesson_example.json
│   ├── lesson_json_documentation.md
│   ├── levels.json
│   ├── README_competencies.md
│   ├── skill_example.json
│   ├── students.json
│   ├── subjects.json
│   └── virtues.json
├── backend
│   ├── core
│   │   ├── asgi.py
│   │   ├── __init__.py
│   │   ├── settings.py
│   │   ├── urls.py
│   │   └── wsgi.py
│   ├── crm
│   │   ├── admin.py
│   │   ├── apps.py
│   │   ├── __init__.py
│   │   ├── migrations
│   │   ├── models.py
│   │   ├── serializers.py
│   │   ├── tests.py
│   │   ├── urls.py
│   │   └── views.py
│   ├── curriculum
│   │   ├── admin.py
│   │   ├── apps.py
│   │   ├── __init__.py
│   │   ├── migrations
│   │   ├── models.py
│   │   ├── serializers.py
│   │   ├── tests.py
│   │   ├── urls.py
│   │   └── views.py
│   ├── db.sqlite3
│   ├── db.sqlite3.backup
│   ├── grades
│   │   ├── admin.py
│   │   ├── apps.py
│   │   ├── __init__.py
│   │   ├── migrations
│   │   ├── models.py
│   │   ├── serializers.py
│   │   ├── tests.py
│   │   ├── urls.py
│   │   └── views.py
│   ├── manage.py
│   ├── plans
│   │   ├── admin.py
│   │   ├── apps.py
│   │   ├── __init__.py
│   │   ├── migrations
│   │   ├── models.py
│   │   ├── serializers.py
│   │   ├── tests.py
│   │   ├── urls.py
│   │   └── views.py
│   ├── schedule
│   │   ├── admin.py
│   │   ├── apps.py
│   │   ├── __init__.py
│   │   ├── migrations
│   │   ├── models.py
│   │   ├── serializers.py
│   │   ├── tests.py
│   │   ├── urls.py
│   │   └── views.py
│   └── users
│       ├── admin.py
│       ├── apps.py
│       ├── __init__.py
│       ├── migrations
│       ├── models.py
│       ├── serializers.py
│       ├── tests.py
│       ├── urls.py
│       └── views.py
├── backup_before_reorganization.json
├── DOC
│   ├── 2025-08-12.md
│   ├── ACTIVITIES-LESSON-SELECTION.md
│   ├── DATA-TABLE-COMPONENT.md
│   ├── FILE_STRUCTURE.md
│   ├── IMU-PLAN-GENERATION.md
│   ├── MCP.md
│   └── SERVICES.md
├── frontend
│   ├── eslint.config.mjs
│   ├── next.config.ts
│   ├── next-env.d.ts
│   ├── OPTIMIZATION.md
│   ├── package.json
│   ├── package-lock.json
│   ├── postcss.config.mjs
│   ├── public
│   │   ├── dataTables.js
│   │   ├── file.svg
│   │   ├── globe.svg
│   │   ├── jquery-3.7.1.js
│   │   ├── next.svg
│   │   ├── vercel.svg
│   │   └── window.svg
│   ├── README.md
│   └── src
│       ├── app
│       │   ├── auth
│       │   │   └── login
│       │   │       └── page.tsx
│       │   ├── curators
│       │   │   └── page.tsx
│       │   ├── managers
│       │   │   ├── layout.tsx
│       │   │   └── page.tsx
│       │   ├── mentors
│       │   │   ├── activities
│       │   │   │   ├── components
│       │   │   │   │   ├── AttendanceMarker.tsx
│       │   │   │   │   ├── GradeSelector.tsx
│       │   │   │   │   ├── index.ts
│       │   │   │   │   ├── LessonDetailsPanel.tsx
│       │   │   │   │   ├── LessonInfoCard.tsx
│       │   │   │   │   ├── StudentRow.tsx
│       │   │   │   │   ├── StudentsList.tsx
│       │   │   │   │   └── StudentStats.tsx
│       │   │   │   ├── page.tsx
│       │   │   │   ├── README.md
│       │   │   │   └── types.ts
│       │   │   ├── dashboard
│       │   │   │   └── page.tsx
│       │   │   ├── lessons
│       │   │   │   ├── create
│       │   │   │   │   └── page.tsx
│       │   │   │   ├── edit
│       │   │   │   │   └── [id]
│       │   │   │   │       └── page.tsx
│       │   │   │   └── page.tsx
│       │   │   ├── page.tsx
│       │   │   ├── plans
│       │   │   │   ├── assign
│       │   │   │   │   └── page.tsx
│       │   │   │   ├── create
│       │   │   │   │   └── page.tsx
│       │   │   │   ├── edit
│       │   │   │   │   └── [id]
│       │   │   │   │       └── page.tsx
│       │   │   │   ├── imuplan-assigned
│       │   │   │   │   └── page.tsx
│       │   │   │   └── page.tsx
│       │   │   ├── schedule
│       │   │   │   └── page.tsx
│       │   │   └── students
│       │   │       └── page.tsx
│       │   ├── parents
│       │   │   └── page.tsx
│       │   ├── settings
│       │   │   └── page.tsx
│       │   ├── students
│       │   │   └── page.tsx
│       │   ├── violations
│       │   │   └── page.tsx
│       │   ├── favicon.ico
│       │   ├── globals.css
│       │   ├── layout.tsx
│       │   └── page.tsx
│       ├── components
│       │   ├── auth
│       │   │   └── ClientAuthGuard.tsx
│       │   ├── dashboard
│       │   │   ├── ScheduleCard.tsx
│       │   │   ├── TableCell.tsx
│       │   │   ├── WeeklyScheduleCalendar.tsx
│       │   │   └── WeeklySchedule.tsx
│       │   ├── DataTable
│       │   │   ├── FilterRow.tsx
│       │   │   ├── index.ts
│       │   │   ├── LocalDataTable.tsx
│       │   │   └── ReactDataTable.tsx
│       │   ├── layout
│       │   │   ├── Header.tsx
│       │   │   └── Navigation
│       │   │       ├── BaseNavigation.tsx
│       │   │       ├── MobileNavigation.tsx
│       │   │       ├── index.ts
│       │   │       └── roles
│       │   │           ├── ManagerNavigation.tsx
│       │   │           ├── CuratorNavigation.tsx
│       │   │           ├── MentorNavigation.tsx
│       │   │           ├── StudentNavigation.tsx
│       │   │           └── ParentNavigation.tsx
│       │   └── ui
│       │       ├── Accordion.tsx
│       │       ├── Button.tsx
│       │       ├── Card.tsx
│       │       ├── DualListTransfer.tsx
│       │       ├── DynamicList.tsx
│       │       ├── GenerationResultsModal.tsx
│       │       ├── Input.tsx
│       │       ├── LessonDualListTransfer.tsx
│       │       ├── LoadingSpinner.tsx
│       │       ├── MultiSelect.tsx
│       │       ├── ProgressModal.tsx
│       │       ├── RoleSwitcher.tsx
│       │       ├── Select.tsx
│       │       ├── Textarea.tsx
│       │       └── ViolationFormModal.tsx
│       ├── hooks
│       │   ├── useAuth.ts
│       │   ├── useCurriculum.ts
│       │   ├── useGrades.ts
│       │   ├── useLessonDetails.ts
│       │   ├── useLessons.ts
│       │   ├── useLevels.ts
│       │   ├── usePeriods.ts
│       │   ├── useSchedule.ts
│       │   ├── useSelectedLesson.ts
│       │   ├── useSettings.ts
│       │   ├── useSubjects.ts
│       │   ├── useWeekInfo.ts
│       │   └── useWeeklySchedule.ts
│       ├── lib
│       │   ├── api.ts
│       │   ├── roleUtils.ts
│       │   ├── types.ts
│       │   └── utils.ts
│       ├── styles
│       │   └── datatables.css
│       └── types
│           └── jquery.d.ts
├── package.json
├── package-lock.json
├── PROMPTS
├── README.md
├── requirements.txt
├── tvarkarastis
└── venv
    ├── bin
    │   ├── activate
    │   ├── activate.csh
    │   ├── activate.fish
    │   ├── Activate.ps1
    │   ├── django-admin
    │   ├── normalizer
    │   ├── pip
    │   ├── pip3
    │   ├── pip3.12
    │   ├── python -> python3
    │   ├── python3 -> /usr/bin/python3
    │   ├── python3.12 -> python3
    │   └── sqlformat
    ├── include
    │   └── python3.12
    ├── lib
    │   └── python3.12
    ├── lib64 -> lib
    └── pyvenv.cfg

tree -L 4 -a -I 'node_modules|.git|pycache|.DS_Store|pytest_cache|.vscode'

## GITHUB PUSH PROCESS

*Git workflow documentation to be added as needed*

## DEVELOPMENT COMMANDS

### Docker Operations
```bash
# Full system deployment
docker compose up -d                        # Start all services
docker compose down                         # Stop all services
docker compose build --no-cache             # Rebuild all images
docker compose logs -f                      # View logs

# Production vs Development
DEBUG=False docker compose up -d            # Production with Gunicorn
DEBUG=True docker compose up -d             # Development with Django dev server

# Backend management
docker compose exec backend python manage.py migrate
docker compose exec backend python manage.py createsuperuser
docker compose exec backend python manage.py collectstatic --noinput

# Frontend development
docker compose exec frontend npm run build  # Production build
docker compose exec frontend npm install    # Install new packages

# Container management
docker compose restart backend              # Restart backend service
docker compose restart frontend             # Restart frontend service
docker compose exec backend bash            # Shell into backend container
docker compose exec postgres psql -U dienynas_user -d dienynas_db  # Database access
```

### Production Configuration

**Gunicorn WSGI Server:**
- Configuration: `backend/gunicorn.conf.py`
- Workers: `CPU cores * 2 + 1`
- Startup script: `backend/entrypoint.sh`
- Log files: `/app/logs/gunicorn-access.log`, `/app/logs/gunicorn-error.log`
- Process management: Automatic worker restart, preload application

**Nginx Reverse Proxy:**
- Configuration: `docker/nginx/sites-enabled/a-dienynas.conf`
- Routes: `/api/*` → Backend, `/` → Frontend, `/admin/` → Django Admin
- Static files: Served directly by Nginx for performance
```

### Authentication Setup

**Superuser creation:**
```bash
# Must use email-based authentication (not username)
docker compose exec backend python manage.py shell -c "
from django.contrib.auth import get_user_model
User = get_user_model()
user = User.objects.create_superuser(
    email='admin@admin.com',
    password='admin123',
    first_name='Admin',
    last_name='User'
)
print('Superuser created')
"
```

**Login credentials:** `admin@admin.com / admin123`

### Common Issues & Solutions

1. **Port conflicts (8000/3000):** Kill processes with `kill $(lsof -t -i:8000)`
2. **API 404 errors:** Check URL routing order in `violation/urls.py`
3. **Authentication 401:** Ensure superuser created with email, not username
4. **Frontend cache issues:** Use `docker compose restart frontend`
5. **Database connection:** Check `DATABASE_HOST=postgres` in `.env`

## IMPORTANT

**Key principles for working with A-DIENYNAS:**

1. **Always maintain data integrity** - educational data is critical
2. **Respect user roles** - implement proper permission checks
3. **Document all changes** - especially database migrations and API changes
4. **Test authentication flows** - JWT token handling is crucial
5. **Follow TypeScript patterns** - maintain type safety throughout frontend
6. **Keep API endpoints RESTful** - follow established URL patterns
7. **Preserve existing comments** - they contain important context
8. **Use modular architecture** - maintain separation between Django apps
9. **Handle errors gracefully** - provide meaningful feedback to users
10. **Prioritize performance** - educational systems need to be responsive
11. **Use Docker for all development** - ensures consistent environment
12. **Check URL routing conflicts** - DRF router can override custom paths

### MANDATORY FILE CREATION/EDITING RULES

**When creating or editing ANY file, ALWAYS REQUIRED:**

1. **Line 1:** Must contain the file path and filename
   ```
   # /path/to/filename.ext
   ```

2. **Line 3 onwards:** Must provide a concise description of the file's purpose
   ```
   # Brief description of what this file does, its role in the project,
   # and any important context for other developers
   ```

3. **After file description:** Must include a brief change summary and reason (on new line)
   ```
   # CHANGE: Brief description of what was modified/added and why
   ```

**Example format:**
```python
# backend/users/models.py

# User management models for A-DIENYNAS system
# Defines custom user model with role-based permissions for students, parents, curators, mentors, and administrators
# CHANGE: Added role-based permissions field to User model to support mentor assignment functionality
```

**This rule applies to ALL file types:** Python, TypeScript, JavaScript, CSS, HTML, JSON, Markdown, configuration files, etc.

**Purpose:** Ensures every file is immediately identifiable, its purpose is clear, and recent changes are documented for any developer working on the project.

### DOCUMENTATION STORAGE RULE

**All documentation created upon request or following project guidelines must be stored in the `/DOC` folder.**

This includes:
- API documentation
- Component documentation  
- Process guides
- Technical specifications
- Architecture documents
- User guides
- Development workflows
- Any other project documentation

**File naming convention for documentation:**
```
/DOC/COMPONENT_NAME.md
/DOC/PROCESS_NAME.md  
/DOC/API_ENDPOINT_NAME.md
```

**Purpose:** Centralizes all project documentation in one location for easy access and maintenance.

### STATIC ASSETS ORGANIZATION RULES

**When working with static assets (images, icons, logos, etc.), ALWAYS FOLLOW:**

1. **Directory Structure:** Use organized subdirectories in `frontend/public/images/`
   ```
   frontend/public/images/
   ├── logos/        # Logos and brand assets
   ├── icons/        # Icons (SVG, PNG, ICO)
   ├── backgrounds/  # Background images
   └── avatars/      # Profile pictures
   ```

2. **File Naming:** Use descriptive, lowercase names with hyphens
   ```
   user-profile-icon.svg
   company-logo.png
   login-background.jpg
   ```

3. **File Formats:** Choose appropriate formats
   - **Icons:** SVG (preferred), PNG (with transparency), ICO (Windows)
   - **Logos:** PNG (with transparency), SVG (vector versions)
   - **Photos:** JPG, WebP (modern), PNG (with transparency)
   - **Backgrounds:** JPG, WebP, PNG (with transparency)

4. **Access Pattern:** All assets are automatically accessible from root URL
   ```tsx
   // Access from /images/icons/globe.svg
   <img src="/images/icons/globe.svg" alt="Globe icon" />
   
   // Use Next.js Image component for optimization
   <Image src="/images/backgrounds/login-bg.jpg" alt="Login background" />
   ```

5. **Documentation:** Update `frontend/public/images/README.md` when adding new asset types or changing structure

**Purpose:** Maintains organized, accessible, and optimized static asset management for consistent UI/UX across the application.